(function(){var e=Math.max,t=Math.ceil,n=String.prototype;n.startsWith||(n.startsWith=function(e,t){return this.substr(t||0,e.length)===e});var i=null,o={inheritAttrs:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]instanceof Object&&t[n]instanceof Object&&'function'!==typeof t[n]?this.inheritAttrs(e[n],t[n]):e[n]=t[n]);return e},createMerge:function(e,t){var n={};return e&&this.inheritAttrs(n,this.cloneObj(e)),t&&this.inheritAttrs(n,t),n},extend:function(){return i?(Array.prototype.unshift.apply(arguments,[!0,{}]),i.extend.apply(i,arguments)):o.createMerge.apply(this,arguments)},cloneObj:function(e){if(Object(e)!==e)return e;var t=new e.constructor;for(var n in e)e.hasOwnProperty(n)&&(t[n]=this.cloneObj(e[n]));return t},addEvent:function(e,t,n){i?i(e).on(t+'.treant',n):e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent('on'+t,n):e['on'+t]=n},findEl:function(e,t,n){if(e.tagName)return e;if(n=n||document,i){var o=i(e,n);return t?o.get(0):o}if('#'==e.charAt(0))return n.getElementById(e.substring(1));if('.'==e.charAt(0)){var d=n.getElementsByClassName(e.substring(1));return d.length?d[0]:null}throw new Error('Unknown container element')},getOuterHeight:function(e){var n=1;return'function'==typeof e.getBoundingClientRect?e.getBoundingClientRect().height:i?t(i(e).outerHeight())+n:t(e.clientHeight+o.getStyle(e,'border-top-width',!0)+o.getStyle(e,'border-bottom-width',!0)+o.getStyle(e,'padding-top',!0)+o.getStyle(e,'padding-bottom',!0)+n)},getOuterWidth:function(e){var n=1;return'function'==typeof e.getBoundingClientRect?e.getBoundingClientRect().width:i?t(i(e).outerWidth())+n:t(e.clientWidth+o.getStyle(e,'border-left-width',!0)+o.getStyle(e,'border-right-width',!0)+o.getStyle(e,'padding-left',!0)+o.getStyle(e,'padding-right',!0)+n)},getStyle:function(e,t,n){var i='';return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(e,'').getPropertyValue(t):e.currentStyle&&(t=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),i=e.currentStyle[t]),n?parseFloat(i):i},addClass:function(e,t){i?i(e).addClass(t):!o.hasClass(e,t)&&(e.classList?e.classList.add(t):e.className+=' '+t)},hasClass:function(e,t){return-1<(' '+e.className+' ').replace(/[\n\t]/g,' ').indexOf(' '+t+' ')},toggleClass:function(e,t,n){i?i(e).toggleClass(t,n):n?e.classList.add(t):e.classList.remove(t)},setDimensions:function(e,t,n){i?i(e).width(t).height(n):(e.style.width=t+'px',e.style.height=n+'px')}},d=function(){this.reset()};d.prototype={reset:function(){return this.loading=[],this},processNode:function(e){for(var t=e.nodeDOM.getElementsByTagName('img'),n=t.length;n--;)this.create(e,t[n]);return this},removeAll:function(e){for(var t=this.loading.length;t--;)this.loading[t]===e&&this.loading.splice(t,1);return this},create:function(e,t){function n(){i.removeAll(d),e.width=e.nodeDOM.offsetWidth,e.height=e.nodeDOM.offsetHeight}var i=this,d=t.src;if(0!==t.src.indexOf('data:')){if(this.loading.push(d),t.complete)return n();o.addEvent(t,'load',n),o.addEvent(t,'error',n),t.src+=(0<t.src.indexOf('?')?'&':'?')+new Date().getTime()}else n()},isNotLoading:function(){return 0===this.loading.length}};var r={store:[],createTree:function(e,t){var n=this.store.length;return this.store.push(new a(e,n,t)),this.get(n)},get:function(e){return this.store[e]},destroy:function(e){var t=this.get(e);if(t){t._R.remove();for(var n=t.drawArea;n.firstChild;)n.removeChild(n.firstChild);for(var o,d=n.className.split(' '),r=[],a=0;a<d.length;a++)o=d[a],'Treant'!=o&&'Treant-loaded'!=o&&r.push(o);n.style.overflowY='',n.style.overflowX='',n.className=r.join(' '),this.store[e]=null}return this}},a=function e(t,n,i){this.reset=function(t,n,i){if(this.initJsonConfig=t,this.initTreeId=n,this.id=n,this.CONFIG=o.extend(e.CONFIG,t.chart),this.drawArea=o.findEl(this.CONFIG.container,!0),!this.drawArea)throw new Error('Failed to find element by selector "'+this.CONFIG.container+'"');return o.addClass(this.drawArea,'Treant'),this.drawArea.innerHTML='',this.imageLoader=new d,this.nodeDB=new l(t.nodeStructure,this,i),this.connectionStore={},this.loaded=!1,this._R=new Raphael(this.drawArea,100,100),this},this.reload=function(){return this.reset(this.initJsonConfig,this.initTreeId,i).redraw(),this},this.reset(t,n,i)};a.prototype={getNodeDb:function(){return this.nodeDB},addNode:function(e,t){this.nodeDB.get(e.id);this.CONFIG.callback.onBeforeAddNode.apply(this,[e,t]);var n=this.nodeDB.createNode(t,e.id,this);return n.createGeometry(this),n.parent().createSwitchGeometry(this),this.positionTree(),this.CONFIG.callback.onAfterAddNode.apply(this,[n,e,t]),n},redraw:function(){return this.positionTree(),this},positionTree:function(e){var t=this;if(this.imageLoader.isNotLoading()){var n=this.root(),i=this.CONFIG.rootOrientation;this.resetLevelData(),this.firstWalk(n,0),this.secondWalk(n,0,0,0),this.positionNodes(),this.CONFIG.animateOnInit&&setTimeout(function(){n.toggleCollapse()},this.CONFIG.animateOnInitDelay),this.loaded||(o.addClass(this.drawArea,'Treant-loaded'),'[object Function]'===Object.prototype.toString.call(e)&&e(t),t.CONFIG.callback.onTreeLoaded.apply(t,[n]),this.loaded=!0)}else setTimeout(function(){t.positionTree(e)},10);return this},firstWalk:function(e,t){e.prelim=null,e.modifier=null,this.setNeighbors(e,t),this.calcLevelDim(e,t);var o=e.leftSibling();if(0===e.childrenCount()||t==this.CONFIG.maxDepth)e.prelim=o?o.prelim+o.size()+this.CONFIG.siblingSeparation:0;else{for(var d=0,i=e.childrenCount();d<i;d++)this.firstWalk(e.childAt(d),t+1);var n=e.childrenCenter()-e.size()/2;o?(e.prelim=o.prelim+o.size()+this.CONFIG.siblingSeparation,e.modifier=e.prelim-n,this.apportion(e,t)):e.prelim=n,e.stackParent?e.modifier+=this.nodeDB.get(e.stackChildren[0]).size()/2+e.connStyle.stackIndent:e.stackParentId&&(e.prelim=0)}return this},apportion:function(e,t){for(var n=e.firstChild(),o=n.leftNeighbor(),d=1,r=this.CONFIG.maxDepth-t;n&&o&&d<=r;){for(var a=0,l=0,s=o,h=n,c=0;c<d;c++)s=s.parent(),h=h.parent(),l+=s.modifier,a+=h.modifier,void 0!==h.stackParent&&(a+=h.size()/2);var i=o.prelim+l+o.size()+this.CONFIG.subTeeSeparation-(n.prelim+a);if(0<i){for(var p=e,g=0;p&&p.id!=s.id;)p=p.leftSibling(),g++;if(p)for(var y=e,m=i/g;y.id!=s.id;)y.prelim+=i,y.modifier+=i,i-=m,y=y.leftSibling()}d++,n=0===n.childrenCount()?e.leftMost(0,d):n=n.firstChild(),n&&(o=n.leftNeighbor())}},secondWalk:function(e,t,n,i){if(t<=this.CONFIG.maxDepth){var o,d,r=e.prelim+n,a=i,l=this.CONFIG.nodeAlign,s=this.CONFIG.rootOrientation;if('NORTH'==s||'SOUTH'==s?(o=this.levelMaxDim[t].height,d=e.height,e.pseudo&&(e.height=o)):('WEST'==s||'EAST'==s)&&(o=this.levelMaxDim[t].width,d=e.width,e.pseudo&&(e.width=o)),e.X=r,e.pseudo?'NORTH'==s||'WEST'==s?e.Y=a:('SOUTH'==s||'EAST'==s)&&(e.Y=a+(o-d)):e.Y='CENTER'==l?a+(o-d)/2:'TOP'==l?a+(o-d):a,'WEST'==s||'EAST'==s){var h=e.X;e.X=e.Y,e.Y=h}'SOUTH'==s?e.Y=-e.Y-d:'EAST'==s&&(e.X=-e.X-d),0!==e.childrenCount()&&(0===e.id&&this.CONFIG.hideRootNode?this.secondWalk(e.firstChild(),t+1,n+e.modifier,i):this.secondWalk(e.firstChild(),t+1,n+e.modifier,i+o+this.CONFIG.levelSeparation)),e.rightSibling()&&this.secondWalk(e.rightSibling(),t,n,i)}},positionNodes:function(){var e=Math.abs,t=this,n={x:t.nodeDB.getMinMaxCoord('X',null,null),y:t.nodeDB.getMinMaxCoord('Y',null,null)},o=n.x.max-n.x.min,d=n.y.max-n.y.min,r={x:n.x.max-o/2,y:n.y.max-d/2};this.handleOverflow(o,d);var a,i,l,s={x:t.drawArea.clientWidth/2,y:t.drawArea.clientHeight/2},h=s.x-r.x,c=s.y-r.y,p=0>=n.x.min+h?e(n.x.min):0,g=0>=n.y.min+c?e(n.y.min):0;for(a=0,i=this.nodeDB.db.length;a<i;a++){if(l=this.nodeDB.get(a),t.CONFIG.callback.onBeforePositionNode.apply(t,[l,a,s,r]),0===l.id&&this.CONFIG.hideRootNode){t.CONFIG.callback.onAfterPositionNode.apply(t,[l,a,s,r]);continue}l.X+=p+(o<this.drawArea.clientWidth?h:this.CONFIG.padding),l.Y+=g+(d<this.drawArea.clientHeight?c:this.CONFIG.padding);var y=l.collapsedParent(),m=null;y?(m=y.connectorPoint(!0),l.hide(m)):l.positioned?l.show():(l.nodeDOM.style.left=l.X+'px',l.nodeDOM.style.top=l.Y+'px',l.positioned=!0),0===l.id||0===l.parent().id&&this.CONFIG.hideRootNode?!this.CONFIG.hideRootNode&&l.drawLineThrough&&l.drawLineThroughMe():this.setConnectionToParent(l,m),t.CONFIG.callback.onAfterPositionNode.apply(t,[l,a,s,r])}return this},handleOverflow:function(e,t){var n=e<this.drawArea.clientWidth?this.drawArea.clientWidth:e+2*this.CONFIG.padding,d=t<this.drawArea.clientHeight?this.drawArea.clientHeight:t+2*this.CONFIG.padding;if(this._R.setSize(n,d),'resize'==this.CONFIG.scrollbar)o.setDimensions(this.drawArea,n,d);else if(void 0==i||'native'==this.CONFIG.scrollbar)this.drawArea.clientWidth<e&&(this.drawArea.style.overflowX='auto'),this.drawArea.clientHeight<t&&(this.drawArea.style.overflowY='auto');else if('fancy'==this.CONFIG.scrollbar){var r=i(this.drawArea);if(r.hasClass('ps-container'))r.find('.Treant').css({width:n,height:d}),r.perfectScrollbar('update');else{var a=r.wrapInner('<div class="Treant"/>'),l=a.find('.Treant');l.css({width:n,height:d}),a.perfectScrollbar()}}return this},setConnectionToParent:function(e,t){var n,i=e.stackParentId,o=i?this.nodeDB.get(i):e.parent(),d=t?this.getPointPathString(t):this.getPathString(o,e,i);return this.connectionStore[e.id]?(n=this.connectionStore[e.id],this.animatePath(n,d)):(n=this._R.path(d),this.connectionStore[e.id]=n,e.pseudo&&delete o.connStyle.style['arrow-end'],o.pseudo&&delete o.connStyle.style['arrow-start'],n.attr(o.connStyle.style),(e.drawLineThrough||e.pseudo)&&e.drawLineThroughMe(t)),e.connector=n,this},getPointPathString:function(e){return['_M',e.x,',',e.y,'L',e.x,',',e.y,e.x,',',e.y].join(' ')},animatePath:function(e,t){return e.hidden&&'_'!==t.charAt(0)&&(e.show(),e.hidden=!1),e.animate({path:'_'===t.charAt(0)?t.substring(1):t},this.CONFIG.animation.connectorsSpeed,this.CONFIG.animation.connectorsAnimation,function(){'_'===t.charAt(0)&&(e.hide(),e.hidden=!0)}),this},getPathString:function(e,t,n){var i=e.connectorPoint(!0),o=t.connectorPoint(!1),d=this.CONFIG.rootOrientation,r=e.connStyle.type,a={},l={};'NORTH'==d||'SOUTH'==d?(a.y=l.y=(i.y+o.y)/2,a.x=i.x,l.x=o.x):('EAST'==d||'WEST'==d)&&(a.x=l.x=(i.x+o.x)/2,a.y=i.y,l.y=o.y);var s,h,c=i.x+','+i.y,p=a.x+','+a.y,g=l.x+','+l.y,y=o.x+','+o.y,m=(a.x+l.x)/2+','+(a.y+l.y)/2;if(!n)'step'==r?s=['M',c,'L',p,'L',g,'L',y]:'curve'==r?s=['M',c,'C',p,g,y]:'bCurve'==r?s=['M',c,'Q',p,m,'T',y]:'straight'==r&&(s=['M',c,'L',c,y]);else if(h='EAST'==d||'WEST'==d?o.x+','+i.y:i.x+','+o.y,'step'==r||'straight'==r)s=['M',c,'L',h,'L',y];else if('curve'==r||'bCurve'==r){var C,N=e.connStyle.stackIndent;'NORTH'==d?C=o.x-N+','+(o.y-N):'SOUTH'==d?C=o.x-N+','+(o.y+N):'EAST'==d?C=o.x+N+','+i.y:'WEST'==d&&(C=o.x-N+','+i.y),s=['M',c,'L',C,'S',h,y]}return s.join(' ')},setNeighbors:function(e,t){return e.leftNeighborId=this.lastNodeOnLevel[t],e.leftNeighborId&&(e.leftNeighbor().rightNeighborId=e.id),this.lastNodeOnLevel[t]=e.id,this},calcLevelDim:function(t,n){return this.levelMaxDim[n]={width:e(this.levelMaxDim[n]?this.levelMaxDim[n].width:0,t.width),height:e(this.levelMaxDim[n]?this.levelMaxDim[n].height:0,t.height)},this},resetLevelData:function(){return this.lastNodeOnLevel=[],this.levelMaxDim=[],this},root:function(){return this.nodeDB.get(0)}};var l=function(e,t,n){this.reset(e,t,n)};l.prototype={reset:function(e,t,n){function d(e,n){var a=r.createNode(e,n,t,null);if(e.children){if(e.childrenDropLevel&&0<e.childrenDropLevel)for(;e.childrenDropLevel--;){var l=o.cloneObj(a.connStyle);a=r.createNode('pseudo',a.id,t,null),a.connStyle=l,a.children=[]}var s=e.stackChildren&&!r.hasGrandChildren(e)?a.id:null;null!==s&&(a.stackChildren=[]);for(var h=0,i=e.children.length;h<i;h++)null===s?d(e.children[h],a.id):(a=r.createNode(e.children[h],a.id,t,s),h+1<i&&(a.children=[]))}}this.db=[];var r=this;return t.CONFIG.animateOnInit&&(e.collapsed=!0),d(e,-1),this.createGeometries(t,n),this},createGeometries:function(e,t){for(var n=this.db.length;n--;)this.get(n).createGeometry(e,t);return this},get:function(e){return this.db[e]},walk:function(e){for(var t=this.db.length;t--;)e.apply(this,[this.get(t)]);return this},createNode:function(t,n,i,o){var d=new s(t,this.db.length,n,i,o);if(this.db.push(d),0<=n){var r=this.get(n);if(!t.position)r.children.push(d.id);else if('left'==t.position)r.children.push(d.id);else if('right'==t.position)r.children.splice(0,0,d.id);else if('center'==t.position)r.children.splice(Math.floor(r.children.length/2),0,d.id);else{var a=parseInt(t.position);1==r.children.length&&0<a?r.children.splice(0,0,d.id):r.children.splice(e(a,r.children.length-1),0,d.id)}}return o&&(this.get(o).stackParent=!0,this.get(o).stackChildren.push(d.id)),d},getMinMaxCoord:function(e,t,n){t=t||this.get(0),n=n||{min:t[e],max:t[e]+('X'==e?t.width:t.height)};for(var o=t.childrenCount();o--;){var i=t.childAt(o),d=i[e]+('X'==e?i.width:i.height),r=i[e];d>n.max&&(n.max=d),r<n.min&&(n.min=r),this.getMinMaxCoord(e,i,n)}return n},hasGrandChildren:function(e){for(var t=e.children.length;t--;)if(e.children[t].children)return!0;return!1}};var s=function(e,t,n,i,o){this.reset(e,t,n,i,o)};s.prototype={reset:function(e,t,n,i,d){return this.id=t,this.parentId=n,this.treeId=i.id,this.prelim=0,this.modifier=0,this.leftNeighborId=null,this.stackParentId=d,this.pseudo='pseudo'===e||e.pseudo,this.meta=e.meta||{},this.image=e.image||null,this.link=o.createMerge(i.CONFIG.node.link,e.link),this.connStyle=o.createMerge(i.CONFIG.connectors,e.connectors),this.connector=null,this.drawLineThrough=!1!==e.drawLineThrough&&(e.drawLineThrough||i.CONFIG.node.drawLineThrough),this.collapsable=!1!==e.collapsable&&(e.collapsable||i.CONFIG.node.collapsable),this.collapsed=e.collapsed,this.text=e.text,this.nodeInnerHTML=e.innerHTML,this.nodeHTMLclass=(i.CONFIG.node.HTMLclass?i.CONFIG.node.HTMLclass:'')+(e.HTMLclass?' '+e.HTMLclass:''),this.nodeHTMLid=e.HTMLid,this.children=[],this},getTree:function(){return r.get(this.treeId)},getTreeConfig:function(){return this.getTree().CONFIG},getTreeNodeDb:function(){return this.getTree().getNodeDb()},lookupNode:function(e){return this.getTreeNodeDb().get(e)},Tree:function(){return r.get(this.treeId)},dbGet:function(e){return this.getTreeNodeDb().get(e)},size:function(){var e=this.getTreeConfig().rootOrientation;if(this.pseudo)return-this.getTreeConfig().subTeeSeparation;return'NORTH'==e||'SOUTH'==e?this.width:'WEST'==e||'EAST'==e?this.height:void 0},childrenCount:function(){return this.collapsed||!this.children?0:this.children.length},childAt:function(e){return this.dbGet(this.children[e])},firstChild:function(){return this.childAt(0)},lastChild:function(){return this.childAt(this.children.length-1)},parent:function(){return this.lookupNode(this.parentId)},leftNeighbor:function(){if(this.leftNeighborId)return this.lookupNode(this.leftNeighborId)},rightNeighbor:function(){if(this.rightNeighborId)return this.lookupNode(this.rightNeighborId)},leftSibling:function(){var e=this.leftNeighbor();if(e&&e.parentId==this.parentId)return e},rightSibling:function(){var e=this.rightNeighbor();if(e&&e.parentId==this.parentId)return e},childrenCenter:function(){var e=this.firstChild(),t=this.lastChild();return e.prelim+(t.prelim-e.prelim+t.size())/2},collapsedParent:function(){var e=this.parent();return!!e&&(e.collapsed?e:e.collapsedParent())},leftMost:function(e,t){if(e>=t)return this;if(0!==this.childrenCount())for(var o,d=0,i=this.childrenCount();d<i;d++)if(o=this.childAt(d).leftMost(e+1,t),o)return o},connectorPoint:function(e){var t=this.Tree().CONFIG.rootOrientation,n={};return this.stackParentId&&('NORTH'==t||'SOUTH'==t?t='WEST':('EAST'==t||'WEST'==t)&&(t='NORTH')),'NORTH'==t?(n.x=this.pseudo?this.X-this.Tree().CONFIG.subTeeSeparation/2:this.X+this.width/2,n.y=e?this.Y+this.height:this.Y):'SOUTH'==t?(n.x=this.pseudo?this.X-this.Tree().CONFIG.subTeeSeparation/2:this.X+this.width/2,n.y=e?this.Y:this.Y+this.height):'EAST'==t?(n.x=e?this.X:this.X+this.width,n.y=this.pseudo?this.Y-this.Tree().CONFIG.subTeeSeparation/2:this.Y+this.height/2):'WEST'==t&&(n.x=e?this.X+this.width:this.X,n.y=this.pseudo?this.Y-this.Tree().CONFIG.subTeeSeparation/2:this.Y+this.height/2),n},pathStringThrough:function(){var e=this.connectorPoint(!0),t=this.connectorPoint(!1);return['M',e.x+','+e.y,'L',t.x+','+t.y].join(' ')},drawLineThroughMe:function(e){var t=e?this.Tree().getPointPathString(e):this.pathStringThrough();this.lineThroughMe=this.lineThroughMe||this.Tree()._R.path(t);var n=o.cloneObj(this.connStyle.style);delete n['arrow-start'],delete n['arrow-end'],this.lineThroughMe.attr(n),e&&(this.lineThroughMe.hide(),this.lineThroughMe.hidden=!0)},addSwitchEvent:function(t){var n=this;o.addEvent(t,'click',function(i){return i.preventDefault(),!1!==n.getTreeConfig().callback.onBeforeClickCollapseSwitch.apply(n,[t,i])&&void(n.toggleCollapse(),n.getTreeConfig().callback.onAfterClickCollapseSwitch.apply(n,[t,i]))})},collapse:function(){return this.collapsed||this.toggleCollapse(),this},expand:function(){return this.collapsed&&this.toggleCollapse(),this},toggleCollapse:function(){var e=this.getTree();if(!e.inAnimation){e.inAnimation=!0,this.collapsed=!this.collapsed,o.toggleClass(this.nodeDOM,'collapsed',this.collapsed),e.positionTree();var t=this;setTimeout(function(){e.inAnimation=!1,e.CONFIG.callback.onToggleCollapseFinished.apply(e,[t,t.collapsed])},e.CONFIG.animation.nodeSpeed>e.CONFIG.animation.connectorsSpeed?e.CONFIG.animation.nodeSpeed:e.CONFIG.animation.connectorsSpeed)}return this},hide:function(e){e=e||!1;var t=this.hidden;this.hidden=!0,this.nodeDOM.style.overflow='hidden';var n=this.getTree(),o=this.getTreeConfig(),d={opacity:0};if(e&&(d.left=e.x,d.top=e.y),!this.positioned||t?(this.nodeDOM.style.visibility='hidden',i?i(this.nodeDOM).css(d):(this.nodeDOM.style.left=d.left+'px',this.nodeDOM.style.top=d.top+'px'),this.positioned=!0):i?i(this.nodeDOM).animate(d,o.animation.nodeSpeed,o.animation.nodeAnimation,function(){this.style.visibility='hidden'}):(this.nodeDOM.style.transition='all '+o.animation.nodeSpeed+'ms ease',this.nodeDOM.style.transitionProperty='opacity, left, top',this.nodeDOM.style.opacity=d.opacity,this.nodeDOM.style.left=d.left+'px',this.nodeDOM.style.top=d.top+'px',this.nodeDOM.style.visibility='hidden'),this.lineThroughMe){var r=n.getPointPathString(e);t?this.lineThroughMe.attr({path:r}):n.animatePath(this.lineThroughMe,n.getPointPathString(e))}return this},hideConnector:function(){var e=this.Tree(),t=e.connectionStore[this.id];return t&&t.animate({opacity:0},e.CONFIG.animation.connectorsSpeed,e.CONFIG.animation.connectorsAnimation),this},show:function(){this.hidden;this.hidden=!1,this.nodeDOM.style.visibility='visible';var e=this.Tree(),t={left:this.X,top:this.Y,opacity:1},n=this.getTreeConfig();return i?i(this.nodeDOM).animate(t,n.animation.nodeSpeed,n.animation.nodeAnimation,function(){this.style.overflow=''}):(this.nodeDOM.style.transition='all '+n.animation.nodeSpeed+'ms ease',this.nodeDOM.style.transitionProperty='opacity, left, top',this.nodeDOM.style.left=t.left+'px',this.nodeDOM.style.top=t.top+'px',this.nodeDOM.style.opacity=t.opacity,this.nodeDOM.style.overflow=''),this.lineThroughMe&&this.getTree().animatePath(this.lineThroughMe,this.pathStringThrough()),this},showConnector:function(){var e=this.Tree(),t=e.connectionStore[this.id];return t&&t.animate({opacity:1},e.CONFIG.animation.connectorsSpeed,e.CONFIG.animation.connectorsAnimation),this}},s.prototype.buildNodeFromText=function(e){if(this.image&&(image=document.createElement('img'),image.src=this.image,e.appendChild(image)),this.text)for(var t in this.text){t.startsWith('data-')&&e.setAttribute(t,this.text[t]);var n=document.createElement(this.text[t].href?'a':'p');this.text[t].href&&(n.href=this.text[t].href,this.text[t].target&&(n.target=this.text[t].target)),n.className='node-'+t,n.appendChild(document.createTextNode(this.text[t].val?this.text[t].val:this.text[t]instanceof Object?'\'val\' param missing!':this.text[t])),e.appendChild(n)}return e},s.prototype.buildNodeFromHtml=function(e){if('#'===this.nodeInnerHTML.charAt(0)){var t=document.getElementById(this.nodeInnerHTML.substring(1));t?(e=t.cloneNode(!0),e.id+='-clone',e.className+=' node'):e.innerHTML='<b> Wrong ID selector </b>'}else e.innerHTML=this.nodeInnerHTML;return e},s.prototype.createGeometry=function(e,t){if(0===this.id&&e.CONFIG.hideRootNode)return this.width=0,void(this.height=0);var n=e.drawArea,o=document.createElement(this.link.href?'a':'div');o.className=this.pseudo?'pseudo':s.CONFIG.nodeHTMLclass,this.nodeHTMLclass&&!this.pseudo&&(o.className+=' '+this.nodeHTMLclass),this.nodeHTMLid&&(o.id=this.nodeHTMLid),this.link.href&&(o.href=this.link.href,o.target=this.link.target),i?i(o).data('treenode',this):o.data={treenode:this},this.pseudo||(o=this.nodeInnerHTML?this.buildNodeFromHtml(o,t):this.buildNodeFromText(o,t),(this.collapsed||this.collapsable&&this.childrenCount()&&!this.stackParentId)&&this.createSwitchGeometry(e,o)),e.CONFIG.callback.onCreateNode.apply(e,[this,o]),n.appendChild(o),this.width=o.offsetWidth,this.height=o.offsetHeight,this.nodeDOM=o,e.imageLoader.processNode(this)},s.prototype.createSwitchGeometry=function(e,t){t=t||this.nodeDOM;var n=o.findEl('.collapse-switch',!0,t);return n||(n=document.createElement('a'),n.className='collapse-switch',t.appendChild(n),this.addSwitchEvent(n),this.collapsed&&(t.className+=' collapsed'),e.CONFIG.callback.onCreateNodeCollapseSwitch.apply(e,[this,t,n])),n},a.CONFIG={maxDepth:100,rootOrientation:'NORTH',nodeAlign:'CENTER',levelSeparation:30,siblingSeparation:30,subTeeSeparation:30,hideRootNode:!1,animateOnInit:!1,animateOnInitDelay:500,padding:15,scrollbar:'native',connectors:{type:'curve',style:{stroke:'black'},stackIndent:15},node:{link:{target:'_self'}},animation:{nodeSpeed:450,nodeAnimation:'linear',connectorsSpeed:450,connectorsAnimation:'linear'},callback:{onCreateNode:function(){},onCreateNodeCollapseSwitch:function(){},onAfterAddNode:function(){},onBeforeAddNode:function(){},onAfterPositionNode:function(){},onBeforePositionNode:function(){},onToggleCollapseFinished:function(){},onAfterClickCollapseSwitch:function(){},onBeforeClickCollapseSwitch:function(){},onTreeLoaded:function(){}}},s.CONFIG={nodeHTMLclass:'node'};var h={make:function(e){var t,n=e.length;for(this.jsonStructure={chart:null,nodeStructure:null};n--;){if(t=e[n],t.hasOwnProperty('container')){this.jsonStructure.chart=t;continue}t.hasOwnProperty('parent')||t.hasOwnProperty('container')||(this.jsonStructure.nodeStructure=t,t._json_id=0)}return this.findChildren(e),this.jsonStructure},findChildren:function(e){for(var t=[0];t.length;){for(var n=t.pop(),o=this.findNode(this.jsonStructure.nodeStructure,n),d=0,i=e.length,r=[];d<i;d++){var a=e[d];a.parent&&a.parent._json_id==n&&(a._json_id=this.getID(),delete a.parent,r.push(a),t.push(a._json_id))}r.length&&(o.children=r)}},findNode:function(e,t){var n,i;if(e._json_id===t)return e;if(e.children)for(n=e.children.length;n--;)if(i=this.findNode(e.children[n],t),i)return i},getID:function(){var e=1;return function(){return e++}}()},c=function(e,t,n,o){this.container=o,e instanceof Array&&(e=h.make(e)),n&&(i=n),this.tree=r.createTree(e,o),this.tree.positionTree(t)};c.prototype.destroy=function(){r.destroy(this.tree.id)},window.Treant=c})();